<!DOCTYPE html>
<html>
<head>
  <title>Gerador de PDF a partir de DOCX</title>
</head>
<body>
  <h1>Preencha os campos para gerar um PDF</h1>
  <form id="form">
    <label for="nome">Nome:</label>
    <input type="text" id="nome" name="nome" required><br><br>

    <label for="telefone">Telefone:</label>
    <input type="text" id="telefone" name="telefone" required><br><br>

    <label for="valor">Valor:</label>
    <input type="text" id="valor" name="valor" required><br><br>

    <button type="button" onclick="gerarPDF()">Gerar PDF</button>
  </form>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.25.1/docxtemplater.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pizzip/3.0.0/pizzip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pizzip-utils/3.0.0/pizzip-utils.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script>
    function gerarPDF() {
      // Obter os dados inseridos pelo usuário
      var nome = document.getElementById("nome").value;
      var telefone = document.getElementById("telefone").value;
      var valor = document.getElementById("valor").value;

      // Carregar o modelo DOCX
      var xhr = new XMLHttpRequest();
      xhr.open("GET", "seu_modelo.docx", true);
      xhr.responseType = "arraybuffer";

      xhr.onload = function () {
        var templateData = new Uint8Array(xhr.response);

        // Carregar o modelo DOCX usando PizZip
        var zip = new PizZip(templateData);
        var doc = new window.docxtemplater().loadZip(zip);

        // Definir os dados para o modelo DOCX
        doc.setData({
          nome: nome,
          telefone: telefone,
          valor: valor
        });

        // Renderizar o modelo DOCX com os dados
        doc.render();

        // Obter o conteúdo do documento DOCX renderizado
        var docxBuffer = doc.getZip().generate({ type: "blob" });

        // Converter o documento DOCX preenchido em PDF
        var pdfData = new Blob([docxBuffer], { type: "application/pdf" });
        saveAs(pdfData, "documento.pdf");
      };

      xhr.send();
    }
  </script>
</body>
</html>
